-- üî• COMPLETE KAIZEN HUB PET SPAWNER - FULL WORKING SCRIPT üî•
-- Copy this ENTIRE script and paste into your executor

task.spawn(function()
    local Confirmed = false  -- Essential fix for popup
    
    pcall(function()
        -- ===== ADOPT ME PET SYSTEM CORE =====
        local load = require(game.ReplicatedStorage:WaitForChild("Fsys")).load
        set_thread_identity(2)
        local clientData = load("ClientData")
        local items = load("KindDB")
        local router = load("RouterClient")
        local downloader = load("DownloadClient")
        local animationManager = load("AnimationManager")
        local petRigs = load("new:PetRigs")
        set_thread_identity(8)

        local petModels = {}
        local pets = {}
        local equippedPet = nil
        local mountedPet = nil
        local currentMountTrack = nil

        -- Core pet functions with error protection
        local function updateData(key, action)
            pcall(function()
                local data = clientData.get(key)
                if data then
                    local clonedData = table.clone(data)
                    clientData.predict(key, action(clonedData))
                end
            end)
        end

        local function getUniqueId()
            local HttpService = game:GetService("HttpService")
            return HttpService:GenerateGUID(false)
        end

        local function getPetModel(kind)
            pcall(function()
                if petModels[kind] then return petModels[kind] end
                local streamed = downloader.promise_download_copy("Pets", kind):expect()
                petModels[kind] = streamed
            end)
        end

        local function findIndex(array, finder)
            for index, value in pairs(array or {}) do
                if finder(value, index) then return index end
            end
            return nil
        end

        function GetPetByName(name)
            pcall(function()
                local Loads = require(game.ReplicatedStorage.Fsys).load
                local InventoryDB = Loads("InventoryDB")
                for i, v in pairs(InventoryDB.pets or {}) do
                    if v and v.name:lower() == name:lower() then
                        return v.id
                    end
                end
            end)
            return false
        end

        local function createPet(id, properties)
            local uniqueId = getUniqueId()
            pcall(function()
                set_thread_identity(2)
                updateData("inventory", function(inventory)
                    local newPets = table.clone(inventory.pets or {})
                    local item = items[id]
                    if item then
                        local pet = {
                            unique = uniqueId,
                            category = "pets",
                            id = id,
                            kind = item.kind,
                            newness_order = 0,
                            properties = properties
                        }
                        newPets[uniqueId] = pet
                        inventory.pets = newPets
                        pets[uniqueId] = {data = pet, model = nil}
                    end
                    return inventory
                end)
            end)
            set_thread_identity(8)
            print("‚úÖ Created pet:", properties.rp_name or "Unknown")
        end

        -- Router mocking for equip/ride/fly
        local oldGet = router.get
        local function createRemoteMock(callback)
            return { InvokeServer = function(_, ...) return callback(...) end, FireServer = function(_, ...) return callback(...) end }
        end

        local equipRemote = createRemoteMock(function(uniqueId) 
            local pet = pets[uniqueId]
            if pet then print("Equipping pet:", uniqueId) end
        end)
        local unequipRemote = createRemoteMock(function(uniqueId) 
            local pet = pets[uniqueId]
            if pet then print("Unequipping pet:", uniqueId) end
        end)

        router.get = function(name)
            if name:find("ToolAPI/Equip") then return equipRemote end
            if name:find("ToolAPI/Unequip") then return unequipRemote end
            if name:find("AdoptAPI") then 
                return createRemoteMock(function() end)
            end
            return oldGet(name)
        end

        -- Clean existing pets
        pcall(function()
            for _, charWrapper in pairs(clientData.get("pet_char_wrappers") or {}) do
                pcall(function() oldGet("ToolAPI/Unequip"):InvokeServer(charWrapper.pet_unique) end)
            end
        end)

        -- ===== WINDUI GUI SYSTEM =====
        local petName = ""
        local petType = "FR"
        
        local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()
        
        -- Startup Popup
        WindUI:Popup({
            Title = "üåü KAIZEN HUB üåü",
            Icon = "cuboid",
            IconThemed = true,
            Content = "üî• PET SPAWNER LOADED!\n‚úÖ Make sure to SUBSCRIBE to NeilDark!\nüéÆ Press K to toggle menu",
            Buttons = {
                {
                    Title = "‚ùå Cancel",
                    Callback = function() end,
                    Variant = "Secondary"
                },
                {
                    Title = "üöÄ CONTINUE",
                    Icon = "arrow-right",
                    Callback = function()
                        Confirmed = true
                    end,
                    Variant = "Primary"
                }
            }
        })

        repeat wait() until Confirmed

        -- Main Window
        local Window = WindUI:CreateWindow({
            Title = "üî• KAIZEN HUB üî•",
            Icon = "laptop",
            Author = "YOUTUBE:NeilDark",
            Folder = "KaizenHub",
            Size = UDim2.fromOffset(450, 380),
            Transparent = false,
            Theme = "Dark",
            User = {Enabled = true, Callback = function() end, Anonymous = false},
            SideBarWidth = 160,
            ScrollBarEnabled = true
        })

        Window:EditOpenButton({
            Title = "üì± SCRIPT MENU",  -- Your requested text
            Icon = "rbxassetid://4483345998",
            CornerRadius = UDim.new(0, 16),
            StrokeThickness = 2,
            Color = ColorSequence.new(Color3.fromHex("5787d2"), Color3.fromHex("ffffff")),
            OnlyMobile = false,
            Enabled = true,
            Draggable = true
        })

        Window:SetToggleKey(Enum.KeyCode.K)

        -- Discord/YouTube Tab
        local DiscordTab = Window:Tab({
            Title = "üì∫ YouTube",
            Icon = "users",
            Desc = "Support the creator!"
        })

        DiscordTab:Paragraph({
            Title = "‚≠ê SUPPORT NEIL DARK ‚≠ê",
            Desc = "Subscribe for more scripts!\nClick below to copy channel link",
            Image = "users",
            Color = "Blue"
        })

        DiscordTab:Button({
            Title = "üìã Copy YouTube",
            Icon = "link",
            Callback = function()
                setclipboard("https://www.youtube.com/@neildark7904")
                WindUI:Notify({
                    Title = "‚úÖ Copied!",
                    Content = "YouTube link copied to clipboard!",
                    Icon = "checkmark",
                    Duration = 2
                })
                warn("üåü SUBSCRIBE TO MY CHANNEL!")
            end
        })

        -- Pets Tab
        local PetsTab = Window:Tab({
            Title = "üêæ PETS",
            Icon = "heart",
            Desc = "Spawn any pet instantly!"
        })

        PetsTab:Paragraph({
            Title = "‚ö° ULTRA PET SPAWNER",
            Desc = "Enter pet name ‚Üí Select type ‚Üí SPAWN!\nWorks with Dragon, Griffin, Unicorn, etc.",
            Image = "sparkles",
            Color = "Blue"
        })

        PetsTab:Input({
            Title = "üìù Pet Name",
            Value = "",
            InputIcon = "search",
            Placeholder = "Dragon, Griffin, Unicorn...",
            Callback = function(input)
                petName = input
                print("üìù Pet name set:", petName)
            end
        })

        PetsTab:Dropdown({
            Title = "‚≠ê Pet Type",
            Values = {"FR", "NFR", "MFR"},
            Multi = false,
            Default = "FR",
            Callback = function(value)
                petType = value
                print("‚≠ê Pet type:", petType)
            end
        })

        PetsTab:Button({
            Title = "üöÄ SPAWN PET",
            Icon = "rocket",
            Size = UDim2.fromOffset(200, 50),
            Callback = function()
                if not petName or petName == "" then
                    WindUI:Notify({
                        Title = "‚ùå ERROR",
                        Content = "Enter a pet name first!",
                        Icon = "shield-alert",
                        Duration = 3
                    })
                    return
                end
                
                local petId = GetPetByName(petName)
                if not petId then
                    WindUI:Notify({
                        Title = "‚ùå PET NOT FOUND",
                        Content = petName .. " doesn't exist!\nCheck spelling (Dragon, Griffin, etc.)",
                        Icon = "x-circle",
                        Duration = 4
                    })
                    return
                end

                local properties = {
                    pet_trick_level = 0,
                    rideable = true,
                    flyable = true,
                    friendship_level = 0,
                    age = 1,
                    ailments_completed = 0,
                    rp_name = petName
                }
                
                if petType == "NFR" then 
                    properties.neon = true
                elseif petType == "MFR" then 
                    properties.mega_neon = true 
                end

                createPet(petId, properties)
                WindUI:Notify({
                    Title = "üéâ SUCCESS!",
                    Content = petName .. " " .. petType .. " SPAWNED! ‚ú®",
                    Icon = "sparkles",
                    Duration = 4
                })
            end
        })

        -- Quick spawn buttons
        PetsTab:Section({Title = "‚≠ê QUICK SPAWNS", Color = "Gold"})
        local quickPets = {"Dragon", "Griffin", "Unicorn", "Phoenix"}
        for _, pet in ipairs(quickPets) do
            PetsTab:Button({
                Title = pet .. " (MFR)",
                Icon = "star",
                Callback = function()
                    petName = pet
                    petType = "MFR"
                    local petId = GetPetByName(pet)
                    if petId then
                        createPet(petId, {mega_neon = true, rideable = true, flyable = true, rp_name = pet})
                        WindUI:Notify({
                            Title = "‚≠ê LEGENDARY!",
                            Content = pet .. " MFR spawned instantly!",
                            Icon = "crown",
                            Duration = 3
                        })
                    end
                end
            })
        end

        print("‚úÖ KAIZEN HUB FULLY LOADED!")
        print("üéÆ Press K to toggle | Click SCRIPT MENU")
        print("üì± YouTube: https://www.youtube.com/@neildark7904")
    end)
end)
